<!-- homepage -->
<block wx:if="{{currentTab == 0}}">
	<view class="bg-white-yellow" style="width:100vw; height:100vh; position: fixed">
		<view
			style="width:80vw;text-align:center;margin-left:auto;margin-right:auto; padding-top:8vh; height:17vh; margin-top: auto; margin-bottom: auto">
			<view style="width:80vw;text-align:center;margin-left:auto;margin-right:auto; padding-top:8vh">
				<image src="https://hunger24.cfpa.org.cn/images/cfpa_logo.png"
					style="width:6rem; height:6rem; padding-bottom:0.8rem"></image>
				<image src="https://hunger24.cfpa.org.cn/images/logo.png" style="width:7rem; height:7rem"></image>
				<view style="padding-bottom:50rpx;"><text class="text-lg ">
						体验饥饿 珍惜粮食 拒绝浪费
					</text></view>
				<view style="width: 80vw; position: fixed; bottom: 20vh">
					<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="showModal"
						data-modal-name="intro">
						活动介绍</button>
					<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="showModal"
						data-modal-name="signup">报名挑战</button>
					<button wx:if="{{!isUserInfoAuthorized && canIUse}}"
						class="index-button cu-btn round bg-warm-yellow margin-sm" open-type="getUserInfo"
						bindgetuserinfo="getUserInfo">进入游戏</button>
					<button wx:elif="{{isUserInfoAuthorized}}" class="index-button cu-btn round bg-warm-yellow margin-sm"
						bindtap="switchTab" data-tab-index="1">进入游戏</button>

					<button wx:else>请升级微信版本</button>
				</view>
			</view>

			<!-- <button class="index-button cu-btn round bg-yellow margin-sm" bindtap="toRestaurant">进入饥饿餐厅</button> -->
		</view>
	</view>
	<view class="cu-modal {{modalName == 'intro' ? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content">活动介绍</view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow" style="text-align:left">
				<text class="text-bold">挑战介绍：</text>
				<text>
					饥饿24公益体验活动由中国扶贫基金会发起，倡导18-60周岁有条件的人在10月16日8：00—10月17日24：00期间，挑战24小时不吃饭，体验饥饿、珍惜粮食、拒绝浪费；并邀请参与人为贫困地区和发展中国家儿童送去关爱。（2020年10月16日是联合国确定的第40个世界粮食日，10月17日是中国第7个扶贫日）

				</text>
				<text class="text-bold">游戏规则：</text>
				<text>
					1.饥饿时间进度和抗饥饿能量均达到满格后为挑战成功；
					2.饥饿时间进度用来记录挑战者的饥饿时间，24小时为满格。10月16日8：00 后点击“开始挑战”开启挑战计时；
					3.抗饥饿能量进度用来记录挑战者的能量值，24个能量为满格；
					4.挑战者通过挖农作物小游戏来积攒能量，每个挑战者有5个铲子，每邀请一个朋友或者捐一餐，可获得一个新的铲子。报名成功后可随时通过玩游戏开始积攒能量。

				</text>
				<text style="font-size:0.75rem; color:rgb(131,131,131)">
					温馨提示：
					1.体验者年龄在18-60周岁，体验饥饿24小时“不进食”的网友必须是身体健康的成年人，有慢性病(如高血压、低血压、糖尿病以及低血糖的人建议不要参与)；
					2.体验饥饿24小时“不进食”的网友当天必须保证充分的饮水，建议喝2-3升白开水；
					3.体验饥饿24小时“不进食”的网友当天不能有剧烈的体力运动或辛苦的脑力劳动；
					4.不建议长期体验饥饿“不进食”的活动；
					5.请勿在体验活动前后暴饮暴食。

				</text>
			</view>
		</view>
	</view>

	<view class="cu-modal {{modalName == 'signup'? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow">
				<view class="margin-sm">
					<text>
						你报名参加饥饿24小时挑战成功啦！
						现在就可以点击「进入游戏」开始积攒抗饥饿能量了~10月16日8:00 后点击「开始挑战」开启挑战计时。
					</text>
				</view>
				<view class="margin-sm"> <text>这么有意义的活动当然要邀请朋友为我加油了～点击「上方按钮」，或者保存「下方海报」分享朋友圈吧！</text></view>
				<image style="width:80vw; height:173.2vw" src="https://hunger24.cfpa.org.cn/images/invite_before.png"></image>

				<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="saveImageToAlbum">保存图片</button>
				<button id="signup" class="index-button cu-btn round bg-warm-yellow margin-sm" open-type="share">分享给好友</button>
			</view>
		</view>
	</view>

	<view class="cu-modal {{modalName == 'invite'? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow">
				<view>
					<image class="item-icon" mode="widthFix" src="{{inviterInfo.avatarUrl}}"></image>
					<text style="vertical-align: middle">{{inviterInfo.nickName}}</text>
				</view>
				<view class="margin-sm">
					<text>
						邀请你参加饥饿24小时挑战！接受邀请可以赠送{{inviterInfo.nickName}}一把挖掘「抗饥饿能量」的铲子哦！</text>
				</view>
				<button wx:if="{{!isUserInfoAuthorized && canIUse}}" class="index-button cu-btn round bg-warm-yellow margin-sm"
					open-type="getUserInfo" bindgetuserinfo="toGetUserInfo">接受挑战</button>
				<button wx:elif="{{isUserInfoAuthorized}}" class="index-button cu-btn round bg-warm-yellow margin-sm"
					bindtap="toAcceptChallenge">接受挑战</button>
				<button wx:else>请升级微信版本</button>
				<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="hideModal">残忍拒绝</button>
			</view>
		</view>
	</view>
	<!-- authorization modal -->
	<!-- <view class="cu-modal {{modalName == 'authorize'? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-xl bg-white-yellow">
				<text>授权是为了在排行榜显示用户昵称和头像，授权后才能开始游戏哦！
				</text>
				<button class="index-button cu-btn round bg-yellow margin-lg" open-type="getUserInfo"
					bindgetuserinfo="getUserInfo">确认授权</button>
				<button class="index-button cu-btn round bg-yellow margin-lg" bindtap="hideModal">放弃游戏</button>
			</view>
		</view>
	</view> -->
</block>

<!-- game page -->
<block wx:if="{{currentTab == 1}}">
	<view style="width:100vw; height:100vh; background-image: url('https://hunger24.cfpa.org.cn/images/soil.png')">
		<view style="width:90vw;margin-left:auto;margin-right:auto;">
			<view class="flex solid-bottom justify-between padding-top-sm">
				<text class="cuIcon-back navbar-icon warm-yellow" bindtap="switchTab" data-tab-index="0"></text>
				<view>
					<text class="cuIcon-info navbar-icon warm-yellow" style="margin-right:10rpx" bindtap="showModal"
						data-modal-name="rule"></text>
					<text class="cuIcon-forward navbar-icon warm-yellow" style="margin-right:10rpx" bindtap="showModal"
						data-modal-name="forward"></text>
					<text class="cuIcon-roundclose navbar-icon warm-yellow" bindtap="showModal" data-modal-name="exit"></text>
				</view>
			</view>
			<view class="width-90-inline horizontal-center" style="margin-top:0">
				<text class="text-white" style="width:30vw; text-size:1rem">
					饥饿时间：
				</text>
				<view class="cu-progress round sm striped" style="margin-top:40rpx;">
					<view class="bg-green" style="width:{{remainingTimePercentage}}%;">{{remainingTimePercentage}}%</view>
				</view>
			</view>
			<view class="width-90-inline horizontal-center">
				<text class="text-white" style="width:30vw; text-size:1rem">
					抗饥饿能量：
				</text>
				<view class="cu-progress round sm striped" style="margin-top:40rpx;">
					<view class="bg-red" style="width:{{remainingEnergyPercentage}}%;">{{remainingEnergyPercentage}}%</view>
				</view>
			</view>
			<view class="width-90-inline horizontal-center">
				<text class="text-white" style="text-size:1rem">
					剩余铲子：
				</text>
				<view style="margin-top:20rpx">
					<image wx:for="{{gameSetting.shovel > 10? 10: gameSetting.shovel}}"
						src="https://hunger24.cfpa.org.cn/images/shovel.png" style="width:1.5rem; height:1.5rem"></image>
				</view>
			</view>
		</view>
		<view class="flex align-center" style="position:fixed; top:33vw; bottom:25vw;">
			<view wx:if="{{modalName == null}}" style="margin-top:auto; margin-bottom:auto;">
				<canvas style="width:100vw;height:90vw" canvas-id="game"></canvas>
				<view wx:if="{{gameSetting.shovel > 0}}" style="text-align:center">
					<!-- <button class="index-button cu-btn round bg-warm-yellow margin-sm" style="margin-top:2px"
						bindtap="gameControl">{{gameStatus}}</button> -->
				</view>

			</view>
		</view>
		<view wx:if="{{gameSetting.shovel > 0 && modalName == null}}"
			style="width:100vw;position:fixed; bottom:20vw; text-align:center"><button
				class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="gameControl">{{gameStatus}}</button></view>
	</view>
	<!-- modals -->


	<view class="cu-modal {{modalName == 'rule' ? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content">游戏规则</view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow" style="text-align:left">
				<!-- <text>
					饥饿24小时挑战已经开始...\n
					1. 点击“在这儿挖”开始收割作物吧！\n
					2. 每收割一种作物，你会获取相应的能量~\n
					3. 每次作物收割完，土地上会长出新的作物哦。\n
					4. 但你的能量也会随着时间迁移而消耗。\n
					5. 铲子用尽时，你可以通过邀请好友或捐一餐获得一把铲子。\n
					6. 24小时过去后，若你还有剩余的能量，就是挑战成功啦！\n
					开始挑战吧！
				</text> -->
				<text>
					1）时间进度和能量进度均达到满格后为挑战成功；\n
					2）时间进度用来记录挑战者的饥饿时间，24小时为满格；如果撑不住了，点击退出可中途放弃挑战；\n
					3）能量进度用来记录挑战者的能量值，24个能量为满格；\n
					4）挑战者通过挖农作物小游戏来积攒能量，每个挑战者有5个铲子，每邀请一个朋友或者捐一餐，可获得一个新的铲子。</text>
			</view>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'share' ? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow">
				<text style="text-size:2rem" wx:if="{{collectSuccess}}">恭喜你！收获一个{{cropsData[cropCollected]['name']}},
					抗饥饿能量值+{{cropsData[cropCollected]['val']}}~\n
					{{cropsData[cropCollected]['intro']}}
				</text>
				<text style="text-size:2rem" wx:if="{{!collectSuccess}}">哎呀！很遗憾，你没有收割到抗饥饿能量，继续努力吧~
				</text>
				<!-- <button class="index-button cu-btn round bg-warm-yellow margin-lg" open-type="share"
					data-tab-index="1">邀请好友获取铲子</button> -->
			</view>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'result' ? 'show' : ''}}">
		<view class="cu-dialog bg-white-yellow">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			
			<!-- <view><canvas canvas-id="shareResult" style="width:600px;height:900px"> </canvas></view> -->
			<view class="padding-lg">
				<text wx:if="{{finalSuccess}}">恭喜你！在24小时过去之后还有剩余能量，完成了饥饿24的挑战。你愿意把今天省下的餐费捐给贫困地区和发展中国家的饥饿儿童吗？
				</text>
				<text class="padding-lg" wx:if="{{!finalSuccess}}">差点完成饥饿24小时的你，有没有体会到饥饿的艰辛呢？对好友发起挑战，或者点击下方为贫困地区和发展中国家儿童送去关爱吧~
				</text>
			</view>
			<view>
				<!-- <image style="width:80vw; height:173.2vw" src="https://hunger24.cfpa.org.cn/images/share_poster.png"></image> -->
				<image wx:if="{{finalSuccess}}" src="https://hunger24.cfpa.org.cn/images/success_poster.png" style="width:80vw; height:173.2vw"></image>
	 <image wx:if="{{!finalSuccess}}" src="https://hunger24.cfpa.org.cn/images/failure_poster.png" style="width:80vw; height:173.2vw"></image>

				<button class="index-button cu-btn round bg-warm-yellow margin-lg" bindtap="saveImageToAlbum">保存图片</button>
			</view>
			<button class="index-button cu-btn round bg-warm-yellow margin-lg" bindtap="toDonate">捐一餐</button>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'exit' ? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="padding-lg bg-white-yellow "><text class="padding-lg"
					style="font-size:1rem">24小时饿肚子真的很难，你还能坚持下去继续挑战吗？\n</text>
				<!-- <button class="index-button cu-btn round bg-warm-yellow margin-sm" open-type="share"></button>  -->
				<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="hideModal">再撑一会儿</button><button
					class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="askForDonation">撑不住了</button>
			</view>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'shareShovel'? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow">
				<text>哎呀，铲子没有了！邀请好友或者捐一餐获得更多的铲子吧！
				</text>
				<button class="index-button cu-btn round bg-warm-yellow margin-lg" open-type="share"
					data-tab-index="1">邀请好友</button>
				<button class="index-button cu-btn round bg-warm-yellow margin-lg" bindtap="toDonate">捐一餐</button>
			</view>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'donate'? 'show' : ''}}">
		<view class="cu-dialog">
			<view class="cu-bar justify-end bg-white-yellow">
				<view class="content"></view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg bg-white-yellow">
				<text>24小时饥饿真的很难，难以想象饥饿的孩子们是怎么撑下来的，你愿意为还在忍受饥饿的孩子捐一餐吗？
				</text>
				<button class="index-button cu-btn round bg-warm-yellow margin-lg" bindtap="toDonate">当然愿意</button>
				<button class="index-button cu-btn round bg-warm-yellow margin-lg" bindtap="stopGame">忍心离去</button>
			</view>
		</view>
	</view>
	<view class="cu-modal {{modalName == 'forward'? 'show' : ''}}">
		<view class="cu-dialog bg-white-yellow">
			<view class="cu-bar justify-end ">
				<view class="content"> </view>
				<view class="action" bindtap="hideModal">
					<text class="cuIcon-close text-red"></text>
				</view>
			</view>
			<view class="padding-lg">
			</view>

			<image style="width:80vw; height:173.2vw" src="https://hunger24.cfpa.org.cn/images/invite_before.png"></image>

			<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="saveImageToAlbum">保存图片</button>

			<button id="shovel" class="index-button cu-btn round bg-warm-yellow margin-sm" open-type="share">分享获得铲子</button>
			<button class="index-button cu-btn round bg-warm-yellow margin-sm" bindtap="toDonate"
				style="margin-bottom:50rpx">捐一餐获得铲子</button>
		</view>

	</view>
</block>

<!-- rank page -->
<block wx:if="{{currentTab == 3}}">

	<!-- <view class="bg-white-yellow" style="width:100vw; height:100vh">
<view class="item-box" >
<view  class="text-xl round bg-warm-yellow padding-sm" style="width:50vw; margin-left:auto; margin-right:auto; margin-top:30rpx;margin-bottom:30rpx;text-align:center; "><text>排行榜</text></view>	

  <view class="items">

		<view class="item">
<view class='inner txt round'>
				<i>名次</i>

        <span class="item-data">
          <i>能量值</i>
        </span>
      </view>
		</view>
		<view class="item-list">
    <view wx:for="{{list}}" wx:key="{{index}}" class="item">
      <view class='inner txt'>
        <i>{{item.ranking}}</i>
        <image class="item-icon" mode="widthFix" src="{{item.userAvatar}}"></image>
        <i> {{item.userName}}</i>
        <span class="item-data">
          <i class="rankpace"> {{item.userEnergy}}</i>
        </span>
      </view>
		</view>
	</view>
  </view>
</view>
</view> -->
</block>

<!-- navigation bar -->
<view class="navbar" style="width: 100vw; padding-bottom:25rpx;">
	<view class="navbar-tab" bindtap="switchTab" data-tab-index="0">
		<text class="cuIcon-home navbar-icon" style="color:orange;"></text>
		<view style="color:orange">主页</view>
	</view>
	<!-- <view class="navbar-tab" bindtap="switchTab" data-tab-index="1">
		<text class="cuIcon-cardboard navbar-icon" style="color:orange"></text>
		<view style="color:orange">游戏</view>
	</view> -->
	<view class="navbar-tab" bindtap="toDonate" data-tab-index="2">
		<text class="cuIcon-like navbar-icon" style="color:orange"></text>
		<view style="color:orange">捐一餐</view>
	</view>
	<view class="navbar-tab" bindtap="toRank" data-tab-index="3">
		<text class="cuIcon-rank navbar-icon" style="color:orange"></text>
		<view style="color:orange">排名</view>
	</view>
</view>